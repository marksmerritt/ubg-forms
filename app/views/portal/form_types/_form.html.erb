<!-- TODO: Refactor -->

<%= form_for @form_type do |f| %>
  <div>
    <%= f.label :name %>
    <%= f.text_field :name, id: "field-form-type-name" %>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th></th>
        <th>Name</th>
        <th>Field Type</th>
        <th>Required</th>
      </tr>
    </thead>
    <tbody class="fields">
      <%= f.fields_for :header_fields do |builder| %>
        <%= render "field_fields", f: builder %>
      <% end %>
    </tbody>
  </table>

  <div>
    <%= link_to_add_association "Add header field", f, :fields,  :render_options => { :wrapper => 'inline' },
     :wrap_object => Proc.new { |field| field.type = 'HeaderFormField'; field }, id: "add-header-field-link" %>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th></th>
        <th>Name</th>
        <th>Field Type</th>
        <th>Required</th>
      </tr>
    </thead>
    <tbody class="fields">
      <%= f.fields_for :footer_fields do |builder| %>
        <%= render "field_fields", f: builder %>
      <% end %>
    </tbody>
  </table>

  <div>
    <%= link_to_add_association "Add", f, :fields,  :render_options => { :wrapper => 'inline' },
     :wrap_object => Proc.new { |field| field.type = 'FooterFormField'; field } %>
  </div>

  <%= f.submit form_submit_text(@form_type) %>
<% end %>